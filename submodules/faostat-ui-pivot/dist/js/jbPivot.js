function grp_distinct(a){"use strict";var b={};return b.values=[],b.names={},b.fieldtype="number",b.field=a.field,"undefined"==typeof a.sort?b.sort="ASC":b.sort=a.sort.toUpperCase(),"undefined"!=typeof a.params?b.params=a.params:b.params=null,"undefined"!=typeof a.showAll?b.showAll=a.showAll:b.showAll=!1,b.CalculateValue=function(a){var b,c="";return"function"==typeof a[this.field]?c=a[this.field](this.params):"number"==typeof a[this.field]?c=a[this.field].toString():"string"==typeof a[this.field]&&(c=a[this.field],this.fieldtype="string"),"string"!=typeof c&&(c=""),"undefined"!=typeof this.names[c]?b=this.names[c]:(b=this.values.push(c)-1,this.names[c]=b),b},b.getStringValue=function(a){return this.values[a]},b.DisplayValues=function(a){var b,c;if(this.showAll)for(b=[],c=0;c<this.values.length;c++)b.push(c.toString());else b=a.slice(0);var d=this;return b="string"===this.fieldtype?b.sort(function(a,b){var c=0;return d.values[a]<d.values[b]&&(c=-1),d.values[a]>d.values[b]&&(c=1),c}):b.sort(function(a,b){var c=parseFloat(d.values[a]),e=parseFloat(d.values[b]),f=0;return e>c&&(f=-1),c>e&&(f=1),f}),"DESC"===this.sort&&(b=b.reverse()),b},b}function agregate_average(a){"use strict";var b={};return b.options=$.extend({},a),b.agregate=function(a,b){var c;if(c=a&&"agregate_average"===a.type?{type:"agregate_average",sum:a.sum,count:a.count}:{type:"agregate_average",sum:0,count:0},"agregate_average"===b.type)c.sum+=b.sum,c.count+=b.count;else if("object"==typeof b)if(c.count++,"number"==typeof b[this.options.field])c.sum+=b[this.options.field];else if("string"==typeof b[this.options.field])try{c.sum+=parseInt(b[this.options.field],10)}catch(d){}return c},b.getValue=function(a){var b=null;if(a&&"agregate_average"===a.type&&a.count>0){var c=a.sum/a.count;b=c}return b},b}function agregate_count(){"use strict";var a={};return a.agregate=function(a,b){var c;return c=a&&"agregate_count"===a.type?{type:"agregate_count",count:a.count}:{type:"agregate_count",count:0},"agregate_count"===b.type?c.count+=b.count:"object"==typeof b&&c.count++,c},a.getValue=function(a){var b=null;return a&&"agregate_count"===a.type&&(b=a.count),b},a}function agregate_distinct(a){"use strict";var b={};return b.field=a.field,b.agregate=function(a,b){var c={type:"fa_distinct"};return a&&"fa_distinct"===a.type?"fa_distinct"===b.type?(c.repeated=a.repeated||b.repeated||a.val!==b.val,c.val=a.val):"object"==typeof b&&("number"==typeof b[this.field]||"string"==typeof b[this.field])?(c.repeated=a.repeated||a.val!==b[this.field],c.val=a.val):(c.repeated=a.repeated||null!==a.val,c.val=null):(c.repeated=!1,"fa_distinct"===b.type?c.val=b.val:"object"==typeof b?(c.repeated=!1,"number"==typeof b[this.field]||"string"==typeof b[this.field]?c.val=b[this.field]:c.val=null):c.val=null),c},b.getValue=function(a){var b=null;return a&&"fa_distinct"===a.type&&(b=a.repeated?"*":a.val),b},b}function agregate_sum(a){"use strict";var b={};return b.field=a.field,b.agregate=function(a,b){var c;if(c=a&&"agregate_sum"===a.type?{type:"agregate_sum",sum:a.sum}:{type:"agregate_sum",sum:0},"agregate_sum"===b.type)c.sum+=b.sum;else if("object"==typeof b)if("number"==typeof b[this.field])c.sum+=b[this.field];else if("string"==typeof b[this.field])try{c.sum+=parseInt(b[this.field],10)}catch(d){}return c},b.getValue=function(a){var b=null;return a&&"agregate_sum"===a.type&&(b=a.sum),b},b}function formatter_default(){"use strict";var a={};return a.format=function(a){var b="";try{b=a.toString()}catch(c){}return b},a}$.unc={plugins:{agregates:{},addAgregate:function(a,b){"use strict";this.agregates[a]=b},groupers:{},addGrouper:function(a,b){"use strict";this.groupers[a]=b},formatters:{},addFormatter:function(a,b){"use strict";this.formatters[a]=b}}},$(function(){"use strict";$.widget("unc.jbPivot",{options:{fields:{},summary:!0,copyright:!0,formatter:"default",l_all:"All",l_unused_fields:"Unused fields"},_create:function(){this.CollapsedNodes={},this.renderPending=!1,this.reset(),"undefined"!=typeof this.options.data&&this.insertRecords(this.options.data);var a=this;$(this.element).on("click",".collapse_button",function(b){b.preventDefault(),a._togleCollapse(this.rel)}),$(this.element).on("dragstart",".draggable",function(b){a.pre_post="",a.dragcls="",a.dragdata=$(this).attr("rel"),b.originalEvent.dataTransfer.effectAllowed="move",b.originalEvent.dataTransfer.setData("Text",$(this).attr("rel")),$(".pivot").addClass("drag_in_progress")}),$(this.element).on("dragleave",".dropable",function(b){var c=$(this),d=c.attr("class").match(/\s+(target(X|Y|Z|U)[\d]+)($|\s)/),e="."+d[1],f=a.element;return setTimeout(function(){$(e,f).removeClass("dropping_pre"),$(e,f).removeClass("dropping_post"),a.pre_post="",a.dragcls=""},0),b.stopPropagation(),b.preventDefault(),!1}),$(this.element).on("dragover",".dropable",function(b){var c=$(this),d=$(this).offset(),e=b.originalEvent.pageX-d.left,f=b.originalEvent.pageY-d.top,g=c.attr("class").match(/\s+(target(X|Y|Z|U)([\d]+))($|\s)/);g[3]=parseInt(g[3],10);var h,i="."+g[1],j=a.pre_post,k=a.dragcls;h="Y"===g[2]||"U"===g[2]?f>c.height()/2?"post":"pre":e>c.width()/2?"post":"pre",0===g[3]&&(h="post");var l=a.dragdata,m=$(this).attr("rel");if(a._canMove(l,m,h)){var n=a.element;return(j!==h||i!==k)&&($(i,n).removeClass("dropping_pre"),$(i,n).removeClass("dropping_post"),setTimeout(function(){$(i,n).addClass("dropping_"+h),a.pre_post=h,a.dragcls=i},0)),b.originalEvent.dataTransfer.dropEffect="move",b.stopPropagation(),b.preventDefault(),!1}}),$(this.element).on("drop",".dropable",function(b){var c=$(this),d=$(this).offset(),e=b.originalEvent.pageX-d.left,f=b.originalEvent.pageY-d.top,g=c.attr("class").match(/\s+(target(X|Y|Z|U)([\d]+))($|\s)/);g[3]=parseInt(g[3],10);var h;h="Y"===g[2]||"U"===g[2]?f>c.height()/2?"post":"pre":e>c.width()/2?"post":"pre",0===g[3]&&(h="post");var i=b.originalEvent.dataTransfer.getData("Text"),j=$(this).attr("rel");return a._moveField(i,j,h),b.preventDefault(),!1}),$(this.element).on("dragend",".dropable",function(){var b=a.element;$(".pivot",b).removeClass("drag_in_progress")})},reset:function(){if(this.fields=[],this.afields=[],this.xfields=[],this.yfields=[],this.zfields=[],this.ufields=[],this.fieldNames=[],this.fieldLabels=[],this.formatters=[],("undefined"==typeof this.options.formatter||null===this.options.formatter)&&(this.options.formatter="default"),"string"==typeof this.options.formatter){if("function"!=typeof $.unc.plugins.formatters[this.options.formatter])throw"Formatter: "+this.options.formatter+" is not defined";this.defaultFormatter=$.unc.plugins.formatters[this.options.formatter](this.options)}else{if("function"!=typeof this.options.formatter)throw"Invalid formatter";this.defaultFormatter={format:this.options.formatter}}if(null===this.options.formatter)throw"Formatter not defined";var a,b=0,c={};for(a in this.options.fields)if(this.options.fields.hasOwnProperty(a)){var d=$.extend({agregateType:"distinct",groupType:"distinct",label:a,formatter:null},this.options.fields[a]);if("none"!==d.groupType){if("function"!=typeof $.unc.plugins.groupers[d.groupType])throw"Grouper: "+d.groupType+" is not defined";this.fields.push($.unc.plugins.groupers[d.groupType](d))}else this.fields.push(null);if("none"!==d.agregateType){if("function"!=typeof $.unc.plugins.agregates[d.agregateType])throw"Grouper: "+d.agregateType+" is not defined";this.afields.push($.unc.plugins.agregates[d.agregateType](d))}else this.afields.push(null);if("string"==typeof d.formatter){if("function"!=typeof $.unc.plugins.formatters[d.formatter])throw"Formatter"+d.formatter+" is not defined";this.formatters.push($.unc.plugins.formatters[d.formatter](d))}else"function"==typeof d.formatter?this.formatters.push({format:d.formatter}):this.formatters.push(null);c[a]=b,b++,this.fieldNames.push(a),this.fieldLabels.push(d.label)}var e,f;for(e=0;e<this.options.xfields.length;e++){if(f=this.options.xfields[e],"undefined"==typeof c[f])throw"Field "+f+" in xfields not defined";if(null===typeof this.fields[c[f]])throw"Field "+f+"is not groupable ans is ispecified in xfields";this.xfields.push(c[f]),delete c[f]}for(e=0;e<this.options.yfields.length;e++){if(f=this.options.yfields[e],"undefined"==typeof c[f])throw"Field "+f+" in yfields not defined";if(null===typeof this.fields[c[f]])throw"Field "+f+"is not groupable ans is ispecified in yfields";this.yfields.push(c[f]),delete c[f]}for(e=0;e<this.options.zfields.length;e++){if(f=this.options.zfields[e],"undefined"==typeof c[f])throw"Field "+f+" in zfields not defined";if(null===typeof this.afields[c[f]])throw"Field "+f+"is not agregatable ans is ispecified in zfields";this.zfields.push(c[f]),delete c[f]}for(f in c)c.hasOwnProperty(f)&&this.ufields.push(c[f]);var g=(1<<this.fields.length)-1;this.indexes={},this.indexes_len={},this.indexes[g]={},this.indexes_len[g]=0,this._generate_trees(),this._forceRender()},insertRecords:function(a){var b,c;for(b=0;b<a.length;b++){var d=a[b],e=[];for(c=0;c<this.fields.length;c++)null!==this.fields[c]?e.push(this.fields[c].CalculateValue(d)):e.push(0);for(var f in this.indexes)if(this.indexes.hasOwnProperty(f)){for(var g=e.slice(0),h=0;h<this.fields.length;h++)0===(1<<h&f)&&(g[h]=0);var i=this._arr2idx(g);for("undefined"==typeof this.indexes[f][i]&&(this.indexes[f][i]=[],this.indexes_len[f]++),c=0;c<this.afields.length;c++)null!==this.afields[c]&&(this.indexes[f][i][c]=this.afields[c].agregate(this.indexes[f][i][c],d))}}this._generate_trees(),this._forceRender()},_forceRender:function(){if(!this.renderPending){this.renderPending=!0;var a=this;setTimeout(function(){a.renderPending=!1,a._renderHtml()},100)}},_arr2idx:function(a){return a.join(",")},_idx2arr:function(a){var b,c=a.split(","),d=[];for(b=0;b<c.length;b++)d.push(parseInt(c[b],10));return d},_getValues:function(a){for(var b,c=0,d=0;d<this.fields.length;d++)-1===a[d]?a[d]=0:c|=1<<d;"undefined"==typeof this.indexes[c]&&this._generate_index(c),b=this._arr2idx(a);var e=this.indexes[c][b];return("undefined"==typeof e||null===e)&&(e=new Array(this.afields.length)),e},_generate_index:function(a){var b,c=null;for(b in this.indexes)(a&b)===a&&(null===c||this.indexes_len[b]<this.indexes_len[c])&&(c=b);this.indexes[a]={},this.indexes_len[a]=0;for(var d in this.indexes[c])if(this.indexes[c].hasOwnProperty(d)){var e=this._idx2arr(d);for(b=0;b<this.fields.length;b++)0===(1<<b&a)&&(e[b]=0);var f=this._arr2idx(e);"undefined"==typeof this.indexes[a][f]&&(this.indexes[a][f]=[],this.indexes_len[a]++);for(var g=0;g<this.afields.length;g++)null!==this.afields[g]&&(this.indexes[a][f][g]=this.afields[g].agregate(this.indexes[a][f][g],this.indexes[c][d][g]))}},_generate_trees:function(){var a,b,c=(1<<this.fields.length)-1;this.xtree={childs:{}},this.ytree={childs:{}};for(var d in this.indexes[c])if(this.indexes[c].hasOwnProperty(d)){var e=this._idx2arr(d);for(a=this.xtree,b=0;b<this.xfields.length;b++)"undefined"==typeof a.childs[e[this.xfields[b]]]&&(a.childs[e[this.xfields[b]]]={childs:{}}),a=a.childs[e[this.xfields[b]]];for(a=this.ytree,b=0;b<this.yfields.length;b++)"undefined"==typeof a.childs[e[this.yfields[b]]]&&(a.childs[e[this.yfields[b]]]={childs:{}}),a=a.childs[e[this.yfields[b]]]}},_tree2table:function(a,b,c){var d,e,f,g="y"===a?this.yfields.length:this.xfields.length;e=c.length-1,d=c[e].index.length;var h;if(this._isCollapsed(a,c[e].index))c[e].cells[d]={},c[e].cells[d].spanx=g-d+1,c[e].cells[d].spany=1,h=1;else{var i=c[e].index.slice(0),j=!1;h=0;var k;if(g>d){var l=[];for(f in b.childs)b.childs.hasOwnProperty(f)&&l.push(f);var m="y"===a?this.fields[this.yfields[d]]:this.fields[this.xfields[d]];k=m.DisplayValues(l)}else k=[];for(f=0;f<k.length;f++){j&&c.push({index:i.slice(0),cells:{}}),c[c.length-1].index.push(k[f]);var n;n="undefined"==typeof b.childs[k[f]]?{childs:{},collapsed:!1}:b.childs[k[f]],h+=this._tree2table(a,n,c),j=!0}0===h?(c[e].cells[d]={},c[e].cells[d].spanx=g-d+1,c[e].cells[d].spany=1,h=1):(c[e].cells[d]={},c[e].cells[d].spanx=1,c[e].cells[d].spany=h)}return h},_collapseLink:function(a,b){var c='<A href="#" class="collapse_button" rel="'+this._treeNode2str(a,b)+'">';return c+=this._isCollapsed(a,b)?"+":"-",c+="</A>"},_renderHtml:function(){var a,b,c,d,e,f,g,h=this.xfields.length>this.yfields.length?this.xfields.length:this.yfields.length;h++;var i=[{index:[],cells:{}}];this._tree2table("x",this.xtree,i);var j=[{index:[],cells:{}}];this._tree2table("y",this.ytree,j);var k="";for(k+='<table border="0px" cellspacing="0" cellpadding="0" class="pivot">',k+="<tr>",k+='<th colspan="'+(this.xfields.length+1)+'" rowspan="'+(this.yfields.length+2)+'"',b="",b+=" line_bottom_"+h,b+=" line_right_"+h,k+=' class="'+b+'"',k+=">",k+="</th>",a=j.length*(this.zfields.length>0?this.zfields.length:1),k+="<th colspan="+a+'"',b="dropable toptitle targetY0 line_top_"+h,b+=" line_left_"+h,b+=" line_right_"+h,k+=' class="'+b+'"',k+=' rel="Y,0"',k+=">",this.yfields.length>0&&(k+=this._collapseLink("y",[])),k+=this.options.l_all,k+="</th>",k+="</tr>\n",e=1;e<=this.yfields.length;e++){for(k+="<tr>",d=0;d<j.length;d++)j[d].cells[e]&&(k+='<th draggable="true"',b="draggable dropable toptitle",b+=this._clsLeftLine(j,d,j[d].cells[e].spany),b+=this._clsRightLine(j,d,j[d].cells[e].spany),b+=" targetY"+e,k+=' class="'+b+'"',k+=' rel= "Y,'+e+'"',a=j[d].cells[e].spany*(this.zfields.length>0?this.zfields.length:1),k+=' colspan="'+a+'"',k+=' rowspan="'+j[d].cells[e].spanx+'"',k+=">",e<this.yfields.length&&(k+=this._collapseLink("y",j[d].index.slice(0,e))),k+=this.fields[this.yfields[e-1]].getStringValue(j[d].index[e-1]),k+="</th>");k+="</tr>\n"}for(k+="<tr>",d=0;d<j.length;d++){for(f=0;f<this.zfields.length;f++)k+='<th draggable="true"',b="draggable dropable ztitle",b+=" line_top_0",b+=" targetZ"+(f+1),b+=" line_top_"+h,b+=0===f?this._clsLeftLine(j,d):" line_left_0",b+=f===this.zfields.length-1?this._clsRightLine(j,d):" line_right_0",k+=' class="'+b+'"',k+=' rel= "Z,'+(f+1)+'"',k+=">",k+=this.fieldLabels[this.zfields[f]],k+="</th>";0===this.zfields.length&&(k+="<th",b="dropable ztitle",b+=" line_top_0",b+=" targetZ0",b+=" line_top_"+h,b+=this._clsLeftLine(j,d),b+=this._clsRightLine(j,d),k+=" class='"+b+"'",k+=" rel= 'Z,0'",k+=">",k+="&nbsp;",k+="</th>")}for(k+="<tr>",e=0;e<i.length;e++){for(d=0;d<=this.xfields.length;d++)i[e].cells[d]&&(k+="<th",k+=i[e].cells[d].spanx>1?' colspan="'+i[e].cells[d].spanx+'"':"",k+=i[e].cells[d].spany>1?' rowspan="'+i[e].cells[d].spany+'"':"",b="lefttitle dropable",d>0&&(b+=" draggable"),0===d&&(b+=" line_left_"+h),b+=this._clsTopLine(i,e,i[e].cells[d].spany),b+=this._clsBottomLine(i,e,i[e].cells[d].spany),b+=" targetX"+d,k+=' class="'+b+'"',k+='"',k+=' rel="X,'+d+'"',d>0&&(k+=' draggable="true"'),k+=">",d<this.xfields.length&&(k+=this._collapseLink("x",i[e].index.slice(0,d))),k+=0===d?this.options.l_all:this.fields[this.xfields[d-1]].getStringValue(i[e].index[d-1]),k+="</th>");for(d=0;d<j.length;d++){for(g=[],c=0;c<this.fields.length;c++)g.push(-1);for(c=0;c<i[e].index.length;c++)g[this.xfields[c]]=i[e].index[c];for(c=0;c<j[d].index.length;c++)g[this.yfields[c]]=j[d].index[c];for(l=this._getValues(g),f=0;f<this.zfields.length;f++)k+="<td",b="",b+=this._clsTopLine(i,e),b+=this._clsBottomLine(i,e),b+=0===f?this._clsLeftLine(j,d):" line_left_0",b+=f===this.zfields.length-1?this._clsRightLine(j,d):" line_right_0",k+=' class="'+b+'"',k+=">",k+=this._format(this.afields[this.zfields[f]].getValue(l[this.zfields[f]]),this.zfields[f]),k+="</td>";0===this.zfields.length&&(k+="<td",b="",b+=this._clsTopLine(i,e),b+=this._clsBottomLine(i,e),b+=this._clsLeftLine(j,d),b+=this._clsRightLine(j,d),k+=" class='"+b+"'",k+=">",k+="&nbsp;",k+="</td>")}k+="</tr>"}if(this.options.summary&&this.zfields.length>0){for(k+="<tr>",k+="<td colspan='"+(this.xfields.length+1)+"'",k+=" >",k+="</td>",d=0;d<j.length;d++){for(g=[],c=0;c<this.fields.length;c++)g.push(-1);for(c=0;c<j[d].index.length;c++)g[this.yfields[c]]=j[d].index[c];var l=this._getValues(g);for(f=0;f<this.zfields.length;f++)k+="<td",b="summary",b+=" line_top_"+h,b+=" line_bottom_"+h,b+=0===f?this._clsLeftLine(j,d):" line_left_0",b+=f===this.zfields.length-1?this._clsRightLine(j,d):" line_right_0",k+=' class="'+b+'"',k+=">",k+=this._format(this.afields[this.zfields[f]].getValue(l[this.zfields[f]]),this.zfields[f]),k+="</td>"}k+="</tr>"}var m=1+this.xfields.length+j.length*this.zfields.length;for(k+="<tr><td colspan='"+m,b="",b+=" line_right_"+h,b+=" line_left_"+h,b+=" line_top_"+h,k+=" class='"+b+"'",k+=">",k+="<tr>",c=0;m>c;c++)k+="<td ",b="bordermark",k+=" class='"+b+"'",k+=">",k+="</td>";k+="</tr>",this.options.copyright&&(k+="<tr><td colspan='"+m+"'",b="copyright",k+=" class='"+b+"'",k+=">",k+="<a href='http://www.jbPivot.org'>jbPivot</a> by <a href='http://www.uniclau.org'> Uniclau S.L. &copy; 2013 </a> <a href='http://www.gnu.org/licenses/gpl.html'><img src='http://www.gnu.org/graphics/gplv3-88x31.png'></a>",k+="</tr>"),k+="</table>",this.element[0].innerHTML=k},_treeNode2str:function(a,b){var c,d=[];if(0===b.length)return a;for(c=0;c<this.fields.length;c++)d.push(-1);for(c=0;c<b.length;c++)"y"===a?d[this.yfields[c]]=b[c]:d[this.xfields[c]]=b[c];return d.join(",")},_isCollapsed:function(a,b){var c=this._treeNode2str(a,b);return"undefined"!=typeof this.CollapsedNodes[c]},_togleCollapse:function(a){"undefined"==typeof this.CollapsedNodes[a]?this.CollapsedNodes[a]=!0:delete this.CollapsedNodes[a],this._forceRender()},_canMove:function(a,b,c){var d=a.split(",");d[1]=parseInt(d[1],10);var e=b.split(",");e[1]=parseInt(e[1],10),"pre"===c&&e[1]--,d[1]--;var f=!1;return"Z"===e[0]?"X"===d[0]?f=null!==this.afields[this.xfields[d[1]]]:"Y"===d[0]?f=null!==this.afields[this.yfields[d[1]]]:"Z"===d[0]?f=null!==this.afields[this.zfields[d[1]]]:"U"===d[0]&&(f=null!==this.afields[this.ufields[d[1]]]):"X"===e[0]||"Y"===e[0]?"X"===d[0]?f=null!==this.fields[this.xfields[d[1]]]:"Y"===d[0]?f=null!==this.fields[this.yfields[d[1]]]:"Z"===d[0]?f=null!==this.fields[this.zfields[d[1]]]:"U"===d[0]&&(f=null!==this.fields[this.ufields[d[1]]]):"U"===e[0]&&(f=!0),f},_moveField:function(a,b,c){var d=a.split(",");d[1]=parseInt(d[1],10);var e=b.split(",");e[1]=parseInt(e[1],10),"pre"===c&&e[1]--;var f=-1;if("X"===d[0]?(f=this.xfields[d[1]-1],this.xfields.splice(d[1]-1,1)):"Y"===d[0]?(f=this.yfields[d[1]-1],this.yfields.splice(d[1]-1,1)):"Z"===d[0]?(f=this.zfields[d[1]-1],this.zfields.splice(d[1]-1,1)):"U"===d[0]&&(f=this.ufields[d[1]-1],this.ufields.splice(d[1]-1,1)),-1===f)throw"Assert: "+d[0]+" is an invalid axis";d[0]===e[0]&&d[1]<e[1]&&e[1]--,"X"===e[0]?this.xfields.splice(e[1],0,f):"Y"===e[0]?this.yfields.splice(e[1],0,f):"Z"===e[0]?this.zfields.splice(e[1],0,f):"U"===e[0]&&this.ufields.splice(e[1],0,f),this._generate_trees(),this._forceRender()},_clsLeftLine:function(a,b,c){"undefined"==typeof c&&(c=1);var d,e=" ";if(b>0){for(d=0;d<this.yfields.length&&d<a[b].index.length&&d<a[b-1].index.length&&a[b].index[d]===a[b-1].index[d];)d++;d=this.yfields.length-d}else d=this.xfields.length>this.yfields.length?this.xfields.length:this.yfields.length,d++;return e+=" line_left_"+d},_clsRightLine:function(a,b,c){"undefined"==typeof c&&(c=1);var d,e=" ";if(b+c<a.length){for(d=0;d<this.yfields.length&&d<a[b].index.length&&d<a[b+c].index.length&&a[b].index[d]===a[b+c].index[d];)d++;d=this.yfields.length-d}else d=this.xfields.length>this.yfields.length?this.xfields.length:this.yfields.length,d++;return e+=" line_right_"+d},_clsTopLine:function(a,b,c){"undefined"==typeof c&&(c=1);var d,e=" ";if(b>0){for(d=0;d<this.xfields.length&&d<a[b].index.length&&d<a[b-1].index.length&&a[b].index[d]===a[b-1].index[d];)d++;d=this.xfields.length-d}else d=this.xfields.length>this.yfields.length?this.xfields.length:this.yfields.length,d++;return e+=" line_top_"+d},_clsBottomLine:function(a,b,c){"undefined"==typeof c&&(c=1);var d,e=" ";if(b+c<a.length){for(d=0;d<this.xfields.length&&d<a[b].index.length&&d<a[b+c].index.length&&a[b].index[d]===a[b+c].index[d];)d++;d=this.xfields.length-d}else d=this.xfields.length>this.yfields.length?this.xfields.length:this.yfields.length,d++;return e+=" line_bottom_"+d},_format:function(a,b){var c=null;return null!==this.formatters[b]&&(c=this.formatters[b].format(a,this.fieldNames[b])),("undefined"==typeof c||null===c)&&(c=this.defaultFormatter.format(a,this.fieldNames[b])),c}})}),$.unc.plugins.addGrouper("distinct",grp_distinct),$.unc.plugins.addAgregate("average",agregate_average),$.unc.plugins.addAgregate("count",agregate_count),$.unc.plugins.addAgregate("distinct",agregate_distinct),$.unc.plugins.addAgregate("sum",agregate_sum),$.unc.plugins.addFormatter("default",formatter_default);